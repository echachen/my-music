<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>æˆ‘çš„ç§äººå…¨è‡ªåŠ¨éŸ³ä¹ç«™</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
    <script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
    <style>
        body { margin: 0; background: #e3f2fd; font-family: -apple-system, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; }
        .main-card { width: 90%; max-width: 500px; background: linear-gradient(135deg, #1a73e8, #64b5f6); padding: 20px; border-radius: 20px; box-shadow: 0 10px 30px rgba(26, 115, 232, 0.3); }
        .header { color: white; text-align: center; margin-bottom: 20px; }
        #player { border-radius: 15px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1); background: white; }
    </style>
</head>
<body>

<div class="main-card">
    <div class="header">
        <h2 style="margin:0;">ğŸµ æˆ‘çš„å…¨è‡ªåŠ¨ç”µå°</h2>
        <p style="font-size:12px; opacity:0.8;" id="status">æ­£åœ¨æ‰«ææ­Œæ›²åº“...</p>
    </div>
    <div id="player"></div>
</div>

<script>
    // 1. é…ç½®ä½ çš„ GitHub ä»“åº“ä¿¡æ¯
    const owner = 'echachen'; // ä½ çš„ç”¨æˆ·å
    const repo = 'my-musics';  // ä½ çš„ä»“åº“å

    // 2. è·å–æ­Œæ›²åˆ—è¡¨çš„å‡½æ•°
    async function getMusicList() {
        const url = `https://api.github.com/repos/${owner}/${repo}/contents/`;
        try {
            const response = await fetch(url);
            const files = await response.json();
            
            // è¿‡æ»¤å‡ºæ‰€æœ‰ä»¥ .mp3 ç»“å°¾çš„æ–‡ä»¶
            const musicFiles = files.filter(file => file.name.toLowerCase().endsWith('.mp3'));
            
            // å°†æ–‡ä»¶ä¿¡æ¯è½¬æ¢ä¸º APlayer æ ¼å¼
            return musicFiles.map(file => ({
                name: file.name.replace('.mp3', ''), // è‡ªåŠ¨ç”¨æ–‡ä»¶åå½“æ­Œå
                artist: 'æˆ‘çš„äº‘ç«¯éŸ³ä¹',
                url: file.name, // å› ä¸ºæ–‡ä»¶å°±åœ¨æ ¹ç›®å½•ï¼Œç›´æ¥ç”¨åå­—å³å¯
                cover: 'https://via.placeholder.com/300/1a73e8/ffffff?text=Music'
            }));
        } catch (error) {
            console.error('è·å–åˆ—è¡¨å¤±è´¥:', error);
            document.getElementById('status').innerText = 'åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•';
            return [];
        }
    }

    // 3. åˆå§‹åŒ–æ’­æ”¾å™¨
    async function initPlayer() {
        const songs = await getMusicList();
        
        if (songs.length === 0) {
            document.getElementById('status').innerText = 'ä»“åº“é‡Œè¿˜æ²¡æœ‰æ­Œæ›²å“¦';
            return;
        }

        const ap = new APlayer({
            container: document.getElementById('player'),
            listFolded: false,
            listMaxHeight: '300px',
            theme: '#1a73e8',
            audio: songs // è‡ªåŠ¨ç”Ÿæˆçš„åˆ—è¡¨å¡«å…¥è¿™é‡Œ
        });

        document.getElementById('status').innerText = `å·²è‡ªåŠ¨åŠ è½½ ${songs.length} é¦–æ­Œæ›²`;
    }

    initPlayer();
</script>
</body>
</html>
