<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>æˆ‘çš„éŸ³ä¹ç«™</title>

<!-- Shikwasa -->
<link rel="stylesheet" href="https://unpkg.com/shikwasa@2.2.1/dist/shikwasa.min.css">

<style>
  body {
    margin: 0;
    padding: 20px;
    background: linear-gradient(135deg, #1e3a8a, #2563eb);
    color: #fff;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  }

  .station {
    max-width: 420px;
    margin: auto;
  }

  .title {
    font-size: 22px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 6px;
  }

  .subtitle {
    text-align: center;
    font-size: 13px;
    opacity: .85;
    margin-bottom: 12px;
  }

  #status {
    text-align: center;
    font-size: 12px;
    opacity: .9;
    margin-bottom: 10px;
  }

  #player {
    background: #fff;
    border-radius: 14px;
    padding: 10px;
    box-shadow: 0 10px 30px rgba(0,0,0,.25);
  }
</style>
</head>

<body>

<div class="station">
  <div class="title">ğŸµ æˆ‘çš„éŸ³ä¹ç«™</div>
  <div class="subtitle">Shikwasa Â· è‡ªåŠ¨åŠ è½½æ’­æ”¾åˆ—è¡¨</div>
  <div id="status">â³ æ­£åœ¨åŠ è½½éŸ³ä¹â€¦</div>
  <div id="player"></div>
</div>

<script src="https://unpkg.com/shikwasa@2.2.1/dist/shikwasa.min.js"></script>

<script>
const CONFIG = {
  jsonUrl: 'https://echachen.github.io/my-music/songlist.json'
};

async function initMusicStation() {
  const statusEl = document.getElementById('status');

  try {
    /* â‘  æ‹‰ JSONï¼ˆé˜²ç¼“å­˜ï¼‰ */
    const res = await fetch(CONFIG.jsonUrl + '?t=' + Date.now());
    if (!res.ok) throw new Error('HTTP ' + res.status);

    /* â‘¡ ç”¨ text â†’ JSON.parseï¼Œæœ€ç¨³ */
    const text = await res.text();
    const rawList = JSON.parse(text);

    if (!Array.isArray(rawList)) {
      throw new Error('JSON ä¸æ˜¯æ•°ç»„');
    }

    /* â‘¢ ä»£ç å±‚ä¿®å¤ URL */
    const musicList = rawList.map((item, i) => ({
      title: item.title || `Track ${i + 1}`,
      artist: item.artist || '',
      cover: item.cover || '',
      src: encodeURI(item.src.trim())
    }));

    /* â‘£ åˆå§‹åŒ– Shikwasa */
    new Shikwasa({
      container: () => document.getElementById('player'),
      audio: musicList,
      themeColor: '#2563eb',
      autoplay: false,
      loop: false
    });

    statusEl.textContent = `âœ… å·²åŠ è½½ ${musicList.length} é¦–æ­Œæ›²`;

  } catch (err) {
    console.error(err);
    statusEl.textContent = 'âŒ åŠ è½½å¤±è´¥ï¼š' + err.message;
  }
}

initMusicStation();
</script>

</body>
</html>
