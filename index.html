<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>å’Œå¹³ä¹‹ååœ£ä¹åˆ†äº«</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<style>
body{
    margin:0;
    min-height:100vh;
    font-family:'Segoe UI',system-ui,sans-serif;
    background:linear-gradient(-45deg,#ee7752,#e73c7e,#23a6d5,#23d5ab);
    background-size:400% 400%;
    animation:gradient 15s ease infinite;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    padding-top:40px;
}
@keyframes gradient{
    0%{background-position:0% 50%}
    50%{background-position:100% 50%}
    100%{background-position:0% 50%}
}

.main-card{
    width:95%;
    max-width:520px;
    background:rgba(255,255,255,.06);
    backdrop-filter:blur(14px);
    border-radius:26px;
    padding:25px 16px;
    border:1px solid rgba(255,255,255,.2);
    box-shadow:0 15px 35px rgba(0,0,0,.12);
}

.header{
    text-align:center;
    color:#fff;
    margin-bottom:22px;
}
.header h2{
    margin:0;
    font-weight:300;
    letter-spacing:1px;
    font-size:1.2rem;
}
#status{
    font-size:11px;
    opacity:.6;
    margin-top:6px;
}

/* ===== APlayer æ·±åº¦å‡€åŒ– ===== */
.aplayer{
    background:transparent!important;
    box-shadow:none!important;
    border:none!important;
}
.aplayer-info,
.aplayer-controller{
    background:transparent!important;
    border:none!important;
    box-shadow:none!important;
}

.aplayer-music{
    text-align:center;
    margin-bottom:-30px!important;
}
.aplayer-title{
    color:#fff!important;
    font-size:1.05rem!important;
}
.aplayer-author{
    color:rgba(255,255,255,.7)!important;
}

.aplayer-icon svg{
    fill:#fff!important;
}

.aplayer-bar{
    background:transparent!important;
    height:3px!important;
}
.aplayer-played{
    background:#e91e63!important;
}

.aplayer-list{
    background:transparent!important;
    margin-top:50px!important;
    border:none!important;
}
.aplayer-list li{
    border:none!important;
    color:rgba(255,255,255,.85)!important;
    font-size:15px!important;
}
.aplayer-list li:hover{
    background:rgba(255,255,255,.12)!important;
}
.aplayer-list-light{
    background:rgba(255,255,255,.18)!important;
}

.aplayer-pic .aplayer-button{
    width:46px!important;
    height:46px!important;
    border-radius:14px!important;
    background:rgba(233,30,99,.9)!important;
    box-shadow:0 4px 15px rgba(233,30,99,.45)!important;
}
</style>
</head>

<body>

<div class="main-card">
    <div class="header">
        <h2>ğŸµ å’Œå¹³ä¹‹ååœ£ä¹åˆ†äº«</h2>
        <div id="status">äº‘ç«¯åŒæ­¥ä¸­â€¦</div>
    </div>
    <div id="player"></div>
</div>

<script>
const CONFIG = {
    owner: 'echachen',
    repo: 'my-music',
    branch: 'main',
    artist: 'åœ£ä¹åˆè¾‘',
    cover: 'https://via.placeholder.com/300/ffffff/1a73e8?text=Church+Music'
};

async function initMusicStation(){
    const status = document.getElementById('status');

    try{
        const api = `https://api.github.com/repos/${CONFIG.owner}/${CONFIG.repo}/contents/`;
        const res = await fetch(api);
        if(!res.ok) throw new Error('GitHub API error');

        const files = await res.json();

        const audioList = files
            .filter(f => f.name.toLowerCase().endsWith('.mp3') && f.download_url)
            .map(f => ({
                name: f.name.replace(/\.mp3$/i,''),
                artist: CONFIG.artist,
                url: f.download_url,   // âœ… æ ¸å¿ƒä¿®å¤
                cover: CONFIG.cover
            }));

        if(!audioList.length){
            status.innerText = 'æœªæ‰¾åˆ°å¯æ’­æ”¾çš„åœ£ä¹';
            return;
        }

        const ap = new APlayer({
            container: document.getElementById('player'),
            audio: audioList,
            listFolded: false,
            order: 'list',
            theme: '#e91e63',
            preload: 'metadata'
        });

        /* ç‚¹å‡»åˆ—è¡¨ç«‹å³æ’­æ”¾ï¼ˆä½ ä¹‹å‰æƒ³è¦çš„ï¼‰ */
        ap.on('listswitch', () => {
            ap.play();
        });

        status.innerText = `å·²åŠ è½½ ${audioList.length} é¦–åœ£ä¹`;

    }catch(err){
        console.error(err);
        status.innerText = 'åŒæ­¥å¤±è´¥ï¼Œè¯·ç¨åå†è¯•';
    }
}

initMusicStation();
</script>

</body>
</html>
